FROM node:20-alpine

RUN apk add --no-cache \
    git curl bash \
    python3 make g++

WORKDIR /app

# Change ownership to the node user (UID 1000, GID 1000)
RUN chown -R node:node /app

# Switch to the node user
USER node

# Copy package files and install dependencies
COPY --chown=node:node package*.json ./
RUN npm install

EXPOSE 3000
CMD ["npm", "run", "dev"]
